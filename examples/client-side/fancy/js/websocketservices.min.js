var CaffeinatedRat=CaffeinatedRat||{};CaffeinatedRat.Minecraft=CaffeinatedRat.Minecraft||{};
CaffeinatedRat.Minecraft.WebSocketServices=function(b){this._onlineTimerPID=this._pingTimerPID=0;this._images=[];this._defaultSkin=null;var c=0;this._templatePluginList=this._templateOfflinePlayerList=this._templateWhiteList=this._templateWho=this._pingserverTimeCallback=this._pingDisconnectedCallback=this._pingConnectedCallback=this._profile=null;b=b||{};b.websocketCheck=void 0===b.websocketCheck?!0:b.websocketCheck;if(!("WebSocket"in window)&&b.websocketCheck)throw new CaffeinatedRat.Minecraft.WebSocketServices.NotSupportedException("constructor");
if(void 0!==b.websocketAddress)this._websocketAddress=b.websocketAddress;else throw new CaffeinatedRat.Minecraft.WebSocketServices.InvalidAddressException("constructor");this._pingInterval=void 0!==b.pingInterval?b.pingInterval:15E3;this._onlineInterval=void 0!==b.onlineInterval?b.onlineInterval:15E3;this._debug=void 0!==b.debug?b.debug:!1;this._imageServerURL=void 0!==b.imageServerURL?b.imageServerURL:"http://s3.amazonaws.com/MinecraftSkins/";this._forceDefaultSkin=void 0!==b.forceDefaultSkin?b.forceDefaultSkin:
!1;this._defaultSkin=void 0!==b.defaultSkin?b.defaultSkin:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAgCAMAAACVQ462AAAABGdBTUEAALGPC/xhBQAAAwBQTFRFAAAAHxALIxcJJBgIJBgKJhgLJhoKJxsLJhoMKBsKKBsLKBoNKBwLKRwMKh0NKx4NKx4OLR0OLB4OLx8PLB4RLyANLSAQLyIRMiMQMyQRNCUSOigUPyoVKCgoPz8/JiFbMChyAFtbAGBgAGhoAH9/Qh0KQSEMRSIOQioSUigmUTElYkMvbUMqb0UsakAwdUcvdEgvek4za2trOjGJUj2JRjqlVknMAJmZAJ6eAKioAK+vAMzMikw9gFM0hFIxhlM0gVM5g1U7h1U7h1g6ilk7iFo5j14+kF5Dll9All9BmmNEnGNFnGNGmmRKnGdIn2hJnGlMnWpPlm9bnHJcompHrHZaqn1ms3titXtnrYBttIRttolsvohst4Jyu4lyvYtyvY5yvY50xpaA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPSUN6AAAAQB0Uk5T////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AFP3ByUAAAAYdEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My4zNqnn4iUAAAKjSURBVEhLpZSLVtNAEIYLpSlLSUITLCBaGhNBQRM01M2mSCoXNUURIkZFxQvv/wz6724Wij2HCM7J6UyS/b+dmZ208rsww6jiqo4FhannZb5yDqjaNgDVwE/8JAmCMqF6fwGwbU0CKjD/+oAq9jcM27gxAFpNQxU3Bwi9Ajy8fgmGZuvaGAcIuwFA12CGce1jJESr6/Ot1i3Tnq5qptFqzet1jRA1F2XHWQFAs3RzwTTNhQd3rOkFU7c0DijmohRg1TR9ZmpCN7/8+PX954fb+sTUjK7VLKOYi1IAaTQtUrfm8pP88/vTw8M5q06sZoOouSgHEDI5vrO/eHK28el04yxf3N8ZnyQooZiLfwA0arNb6d6bj998/+vx8710a7bW4E2Uc1EKsEhz7WiQBK9eL29urrzsB8ngaK1JLDUXpYAkGSQH6e7640fL91dWXjxZ33138PZggA+Sz0WQlAL4gmewuzC1uCenqXevMPWc9XrMX/VXh6Hicx4ByHEeAfRg/wtgSMAvz+CKEkYAnc5SpwuD4z70PM+hUf+4348ixF7EGItjxmQcCx/Dzv/SOkuXAF3PdT3GIujjGLELNYwxhF7M4oi//wsgdlYZdMXCmEUUSsSu0OOBACMoBTiu62BdRPEjYxozXFyIpK7IAE0IYa7jOBRqGlOK0BFq3Kdpup3DthFwP9QDlBCGKEECoHEBEDLAXHAQMQnI8jwFYRQw3AMOQAJoOADoAVcDAh0HZAKQZUMZdC43kdeqAPwUBEsC+M4cIEq5KEEBCl90mR8CVR3nxwCdBBS9OAe020UGnXb7KcxzPY9SXoEEIBZtgE7UDgBKyLMhgBS2YdzjMJb4XHRDAPiQhSGjNOxKQIZTgC8BiMECgarxprjjO0OXiV4MAf4A/x0nbcyiS5EAAAAASUVORK5CYII=";
this._imageSmoothing=void 0!==b.imageSmoothing?b.imageSmoothing:!0;this.getCanvasId=function(){return c++};$(".wssMinecraftPlayerList").hide();$(".wssMinecraftWhiteList").hide();$(".wssMinecraftOfflineList").hide();$(".wssMinecraftPluginList").hide()};CaffeinatedRat.Minecraft.WebSocketServices.prototype.getImage=function(b){if(void 0!==this._images)return this._images[b]};
CaffeinatedRat.Minecraft.WebSocketServices.prototype.mapToTemplate=function(b,c,a,d){if(null!=b){var e=b.find(".wssListItemTemplate");if(0<e.length)if(0<a.length){c.find(".wssListItemTemplate").remove();c.find(".wssEmptyListTemplate").remove();b=e.clone();e=b.children(":first").detach();b.appendTo(c);for(i=0;i<a.length;i++)if(void 0!==d)this[d](a[i],b,e);else console.log("CaffeinatedRat.Minecraft.WebSocketServices.mapToTemplate: No mapping function was defined."),c.text("No mapping function was defined.")}else c.find(".wssListItemTemplate").remove(),
c.find(".wssEmptyListTemplate").remove(),a=b.find(".wssEmptyListTemplate").clone(),0<a.length?a.appendTo(c):c.text("No empty-list item template was defined.");else c.find(".wssEmptyListTemplate").remove(),c.text("No list item template was defined.")}else c.find(".wssEmptyListTemplate").remove(),c.text("No list item template was defined.")};
CaffeinatedRat.Minecraft.WebSocketServices.prototype.drawPlayersFace=function(b,c){var a=this;if(void 0===a._images[c]){var d=new Image;d.setAttribute("data-canvasId",b);d.onload=function(){var b=document.getElementById(this.getAttribute("data-canvasId"));if(void 0!==b){var d=b.getContext("2d");void 0!==d&&(d.mozImageSmoothingEnabled=a._imageSmoothing,d.webkitImageSmoothingEnabled=a._imageSmoothing,d.drawImage(this,8,8,8,8,0,0,b.width,b.height))}a._images[c]=this};d.onerror=function(){this.src=this._defaultSkin;
a._images[c]=this};d.src=this._forceDefaultSkin?this._defaultSkin:this._imageServerURL+c+".png"}else{var d=this._images[c],e=document.getElementById(b);if(void 0!==e){var f=e.getContext("2d");void 0!==f&&(f.mozImageSmoothingEnabled=a._imageSmoothing,f.webkitImageSmoothingEnabled=a._imageSmoothing,f.drawImage(d,8,8,8,8,0,0,e.width,e.height))}}};
CaffeinatedRat.Minecraft.WebSocketServices.prototype.playerInfoMapping=function(b,c,a){var d="Online: Now";void 0===b.onlineTime?b.isOnline||(d="Last Played: "+b.lastPlayed+""):d="Online: "+b.onlineTime+"";a=a.clone();b.isOperator?a.find(".wssPlayerIsNotOperator").remove():a.find(".wssPlayerIsOperator").remove();var e="canvas"+this.getCanvasId()+b.name,f="normal";void 0!==b.environment&&(f=b.environment.replace("_","").toLowerCase());a.html(a.html().replace(/#wssPlayerFace#/g,'<canvas class="playersFace" id="'+
e+'"></canvas>'));a.html(a.html().replace(/#wssPlayerIsOperator#/g,b.isOperator));a.html(a.html().replace(/#wssPlayerName#/g,b.name));a.html(a.html().replace(/#wssPlayerEnvironment#/g,f));a.html(a.html().replace(/#wssPlayerOnlineTime#/g,d));a.appendTo(c);this.drawPlayersFace(e,b.name)};
CaffeinatedRat.Minecraft.WebSocketServices.prototype.pluginInfoMapping=function(b,c,a){a=a.clone();a.html(a.html().replace(/#wssPluginName#/g,b.name));a.html(a.html().replace(/#wssPluginVersion#/g,b.version));a.html(a.html().replace(/#wssPluginAuthor#/g,b.author));a.html(a.html().replace(/#wssPluginDescription#/g,b.description));a.appendTo(c)};
CaffeinatedRat.Minecraft.WebSocketServices.prototype.ping=function(b){b=b||{};void 0!==b.connectedCallback&&(this._pingConnectedCallback=b.connectedCallback);void 0!==b.disconnectedCallback&&(this._pingDisconnectedCallback=b.disconnectedCallback);void 0!==b.serverTimeCallback&&(this._pingserverTimeCallback=b.serverTimeCallback);var c=!1,a=new WebSocket(this._websocketAddress),d=this;a.onopen=function(){c=!0;a.send("ping")};a.onmessage=function(a){d._debug&&console.log(a.data);a=jQuery.parseJSON(a.data);
"SUCCESSFUL"==a.Status&&d._pingserverTimeCallback&&d._pingserverTimeCallback(a.serverTime)};a.onclose=function(){c?d._pingConnectedCallback&&d._pingConnectedCallback():d._pingDisconnectedCallback&&d._pingDisconnectedCallback();d._pingTimerPID=setTimeout(function(){d.ping()},d._pingInterval)};a.onerror=function(a){console.log("WebSocket Error "+a)}};
CaffeinatedRat.Minecraft.WebSocketServices.prototype.getServerInfo=function(){var b=new WebSocket(this._websocketAddress),c=this;b.onopen=function(){b.send("info")};b.onmessage=function(a){if(void 0!==a&&(c._debug&&console.log(a.data),a=jQuery.parseJSON(a.data),"SUCCESSFUL"==a.Status))try{$(".wssMinecraftServerName").text(a.serverName),$(".wssMinecraftServerType").text(a.name),$(".wssMinecraftVersion").text(a.version),$(".wssMinecraftBukkitVersion").text(a.bukkitVersion),$(".wssMinecraftMOTD").text(a.motd.replace(/\u00A7/g,
"")),$(".wssMinecraftWorldType").text(a.worldType),$(".wssMinecraftGameMode").text(a.gameMode),$(".wssMinecraftIsWhiteListed").text(a.isWhiteListed),$(".wssMinecraftAllowsNether").text(a.allowsNether),$(".wssMinecraftAllowsEnd").text(a.allowsEnd),$(".wssMinecraftAllowsFlight").text(a.allowsFlight),$(".wssMinecraftPort").text(a.port),$(".wssMinecraftIPAddress").text(a.ipAddress),$(".wssMinecraftTime").text(13E3<=a.serverTime%23E3?"Night":"Day")}catch(b){console.log(b)}};b.onerror=function(a){console.log("WebSocket Error "+
a)}};
CaffeinatedRat.Minecraft.WebSocketServices.prototype.getPlayerInfo=function(b){b=b||{};void 0!==b.updateTime&&(this._onlineInterval=b.updateTime);var c=new WebSocket(this._websocketAddress),a=this;c.onopen=function(){c.send("who")};c.onmessage=function(b){if(void 0!==b){a._debug&&console.log(b.data);try{var c=jQuery.parseJSON(b.data);if("SUCCESSFUL"==c.Status){$(".wssMinecraftMaxNumberOfPlayers").text(c.MaxPlayers);$(".wssMinecraftTotalPlayersOnline").text(c.Players.length);var f=$(".wssMinecraftPlayerList");0<
f.length&&null==a._templateWho&&(a._templateWho=f.clone());a.mapToTemplate(a._templateWho,f,c.Players,"playerInfoMapping")}$(".wssMinecraftPlayerList").show()}catch(g){console.log(g)}}};c.onclose=function(){0<a._onlineInterval&&(a._onlineTimerPID=setTimeout(function(){a.getPlayerInfo()},a._onlineInterval))};c.onerror=function(a){console.log("WebSocket Error "+a)}};
CaffeinatedRat.Minecraft.WebSocketServices.prototype.getWhiteListing=function(){var b=new WebSocket(this._websocketAddress),c=this;b.onopen=function(){b.send("whitelist")};b.onmessage=function(a){if(void 0!==a){c._debug&&console.log(a.data);try{var b=jQuery.parseJSON(a.data);if("SUCCESSFUL"==b.Status){$(".wssTotalWhitelistedPlayers").text(b.Whitelist.length);var e=$(".wssMinecraftWhiteList");0<e.length&&null==c._templateWhiteList&&(c._templateWhiteList=e.clone());c.mapToTemplate(c._templateWhiteList,
e,b.Whitelist,"playerInfoMapping")}$(".wssMinecraftWhiteList").show()}catch(f){console.log(f)}}};b.onerror=function(a){console.log("WebSocket Error "+a)}};
CaffeinatedRat.Minecraft.WebSocketServices.prototype.getOfflinePlayers=function(){var b=new WebSocket(this._websocketAddress),c=this;b.onopen=function(){b.send("offlinePlayers")};b.onmessage=function(a){if(void 0!==a){c._debug&&console.log(a.data);try{var b=jQuery.parseJSON(a.data);if("SUCCESSFUL"==b.Status){$("#wssTotalOfflinePlayers").text(b.OfflinePlayers.length);var e=$(".wssMinecraftOfflineList");0<e.length&&null==c._templateOfflinePlayerList&&(c._templateOfflinePlayerList=e.clone());c.mapToTemplate(c._templateOfflinePlayerList,
e,b.OfflinePlayers,"playerInfoMapping")}$(".wssMinecraftOfflineList").show()}catch(f){console.log(f)}}};b.onerror=function(a){console.log("WebSocket Error "+a)}};
CaffeinatedRat.Minecraft.WebSocketServices.prototype.getPluginInfo=function(){var b=new WebSocket(this._websocketAddress),c=this;b.onopen=function(){b.send("plugins")};b.onmessage=function(a){if(void 0!==a){c._debug&&console.log(a.data);try{var b=jQuery.parseJSON(a.data);if("SUCCESSFUL"==b.Status){var e=$(".wssPluginList");0<e.length&&null==c._templatePluginList&&(c._templatePluginList=e.clone());c.mapToTemplate(c._templatePluginList,e,b.Plugins,"pluginInfoMapping")}$(".wssMinecraftPluginList").show()}catch(f){console.log(f)}}};
b.onerror=function(a){console.log("WebSocket Error "+a)}};CaffeinatedRat.Minecraft.WebSocketServices.Exception=function(b,c){var a="CaffeinatedRat.Minecraft.WebSocketServices"+(void 0!==b?"."+b:""),a=a+(": "+c);this.toString=function(){return a}};CaffeinatedRat.Minecraft.WebSocketServices.NotSupportedException=function(b){CaffeinatedRat.Minecraft.WebSocketServices.Exception.call(this,b,"Websockets are not supported by this browser.")};
CaffeinatedRat.Minecraft.WebSocketServices.InvalidAddressException=function(b,c){var a="CaffeinatedRat.Minecraft.WebSocketServices: No WebSocket address has been provided.";void 0!==c&&(a+="\r\nDetails: "+c);CaffeinatedRat.Minecraft.WebSocketServices.Exception.call(this,b,a)};